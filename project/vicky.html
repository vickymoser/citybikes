<html>
  <head>
    <title>Line chart demo</title>
    <link href="barchart.css" rel="stylesheet" type="text/css"></link>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/colorbrewer.v1.min.js"></script>
    <script src="./function_objects.js"></script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Vickymoser.GitHub.io : Project Website">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">


  <body>


        <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/vickymoser">View on GitHub</a>

          <h1 id="project_title">VIS Project</h1>
          <h2 id="project_tagline">Project Website</h2>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">

    <h1 style="margin-left:50px;">City Bike Vienna: Prediction Tool</h1>
    <!-- step 1: add svg element -->
    <svg id="chart" width="1000" height="500"></svg>


    <!-- step 8: add interactivity -->

    <script src="city_bike_prediction.js"></script>

<div style="display: inline-block; float:left;">
    <div class="slidercontainer"  id="slidercontainer" ></div>


<div style="clear:both;"></div>
  <select id="newFunctionSelect">
    <option value="linear_function">Linear
    <option value="quadratic_function">Quadratisch
    <option value="gaussian_function">Gauss
    <option value="Volvo">Volvo
  </select>
    <button type="button" class="btn btn-default btn-lg" style="float:right" onclick="onClicked()"> 
      <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Neue Function hinzuf√ºgen
    </button>
   
<div style="clear:both;"></div>

    <button type="button" class="btn btn-default btn-lg" style="float:right"> 
      <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Save
    </button>

     
</div>

</br>



<!-- script for creating slider -->
 <script>



    var inputsCounter = 0;

    function onClicked() {
      var type = document.getElementById("newFunctionSelect").value;

      if (type == 'gaussian_function') {
        //console.log("created gaussian_function");
          selectedFunction.addFunction(new GaussianFunction(0.3, 3, 5, 2));
      } else if (type == 'linear_function') {
        //console.log("created linear_function");
        
        selectedFunction.addFunction(new LinearFunction(0.3, 3, 12));
      } else if (type == 'quadratic_function') {
        //console.log("created quadratic_function");

        selectedFunction.addFunction(new QuadraticFunction(0.3));
      }

      createSlider(type);
      //console.log("Add new"+type);
    }

 
    function createSlider(type){

        //Create Container
        var slidersubcontainer = document.createElement("div");
        slidersubcontainer.setAttribute("id","slidersubcontainer"+inputsCounter);
        slidersubcontainer.setAttribute("class", "slidersubcontainer");
        
        slidersubcontainer.addEventListener('mouseenter', function() {
          mouseover(slidersubcontainer);
        },false);

        slidersubcontainer.addEventListener('mouseleave', function() {
          mouseleave(slidersubcontainer);
        },false);


        //Create Label
        var sliderLabel = document.createElement("LABEL");
        sliderLabel.className = "blaaaaaaa";
        sliderLabel.setAttribute("id", "sliderLabel"+inputsCounter);
        sliderLabel.setAttribute("class", "sliderLabel");

        //Create Slider
        var slider = document.createElement("INPUT");
        slider.setAttribute("type", "range");
        slider.setAttribute("id","slider"+inputsCounter);
        slider.setAttribute("min", "0");
        slider.setAttribute("max", "20");


        slidersubcontainer.appendChild(sliderLabel);
        slidersubcontainer.appendChild(slider);

        document.getElementById("slidercontainer").appendChild(slidersubcontainer);

        inputsCounter++;
        

        slider.addEventListener("change", function() {
          update(slider);
        },false);


        slider.addEventListener('mousedown', function() {
          mousedown(slider);
        },false);

        slider.addEventListener('mouseup', function() {
          mouseup(slider);
        },false);

        slider.value = 5;

        update(slider);
    }

    


    function mouseover(subcontainer) {

      //console.log("mouseover");
      var id = subcontainer.id;

      var idx = +id.replace("slidersubcontainer", "");

      showFunction(idx);

     };


    function mousedown(slider) {

      //TODO: Create Phantom Function
      //TODO: Show Phantom Function

      //console.log("mousedown");

      //showPhantomFunction();


     };

      function update(slider) {
        var id = slider.id;

        var idx = +id.replace("slider", "");

        var labelId = "sliderLabel"+idx;

        document.getElementById(labelId).innerHTML =slider.value;
        //slider.value = value;

        var sliderValue = +slider.value;

        var func;

        /*
        if (phantomFunction != null) {
         func = phantomFunction.getFunction(idx);
        } else */
        {
          func = selectedFunction.getFunction(idx);
        }


        //console.log("updated" + func.__type);
        if (func.__type == 'gaussian_function') {
          //console.log("updated gaussian_function");
          func.b = sliderValue;
        } else if (func.__type == 'linear_function') {
          //console.log("updated linear_function");
          func.k = sliderValue;
        } else if (func.__type == 'quadratic_function') {
          //console.log("updated quadratic_function");
          func.weight = sliderValue;
        }

        //func.updateK(sliderValue);
        updateGraph();

     };

    function mouseup(slider) {

      //TODO: Transition Old Function to PhantomFunction then remove Phantom Function

      //console.log("mouseup");

      //hidePhantomFunction();

     };


    function mouseleave(subcontainer) {

      //console.log("mouseleave");
      var id = subcontainer.id;

      var idx = +id.replace("slidersubcontainer", "");

      hideFunction(idx);

     };


    if (!chartIsReady)  {
     onDataLoaded = function() {
        for (var i = selectedFunction.functions.length - 1; i >= 0; i--) {

          var functionType = selectedFunction.getFunction(i).__type;


          createSlider(functionType);
        };
      }
    } else {
      for (var i = selectedFunction.functions.length - 1; i >= 0; i--) {
        createSlider();
      }
    }



</script>



</br>

<!-- table-->
<table class="table", cellpadding="2" >
  <tr>
    <th>#</th>
    <th>View</th> 
    <th>Date</th>
    <th colspan="2">Edit</th>
  </tr>
 
  <tr>
    <td>1</td>
    <td>
    <a href="#child4">Parameter1: 85, Parameter 2: 45, Parameter 3: 97</a></td> 
    <td>26.05.2015</td>
    <td><form><input type=submit value="edit"></form></td>
    <td><form><input type=submit value="delete"></form></td>
  </tr>

  <tr>
    <td>2</td>
    <td>
    <a href="#child4">Parameter1: 85, Parameter 2: 45, Parameter 3: 97</a></td> 
    <td>26.05.2015</td>
    <td><form><input type=submit value="edit"></form></td>
    <td><form><input type=submit value="delete"></form></td>
  </tr>

</table>




  <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>



  </body>


</html>

